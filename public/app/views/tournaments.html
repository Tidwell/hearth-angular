<div class="container" ng-show="loggedIn">
	<div class="row-fluid">
		<div class="pull-right">
			{{userName}}
		</div>
	</div>
</div>
<div class="container" ng-show="!loggedIn">
	<div class="well">
		<h2>Enter your BattleTag</h2>
		<form class="form-horizontal">
			<input type="text" ng-model="userName" />
			<button class="btn" ng-click="login()">Start!</button>
		</form>
		<span class="alert alert-error" ng-show="error">{{error}}</span>
	</div>
</div>

<div class="container" ng-show="!activeTournament">
	<div class="container" ng-show="loggedIn">
		<ng-include src="'views/general-chat.html'"></ng-include>
	</div>

	<h3>Active Tournaments</h3>
	<table class="table table-bordered">
		<thead>
			<tr>
				<th>Bracket</th>
				<th>Rules</th>
				<th>Start Time</th>
				<th>Status</th>
			</tr>
		</thead>
		<tbody>
			<tr ng-repeat="tournament in tournaments" ng-show="isActive(tournament)">
				<td>
					<a ng-show="tournament.tournament.state != 'pending'" href ng-click="view(tournament)">{{tournament.tournament.name}}</a>
					<span ng-show="tournament.tournament.state == 'pending'">{{tournament.tournament.name}}</span>
				</td>
				<td>{{tournament.tournament.tournamentType}}</td>
				<td>
					<span ng-show="tournament.tournament.state == 'pending'">
						Not Started
						<span class="badge badge pull-right">
							{{tournament.tournament.participantsCount}} / {{tournament.tournament.signupCap}}
						</span>
					</span>
					<span ng-show="tournament.tournament.state == 'underway'">
						{{tournament.tournament.startedAt | date:'h:mm a'}}
					</span>
				</td>
				<td>
					<span ng-show="tournament.tournament.state == 'pending' && loggedIn">
						Not Registered
						<button class="pull-right btn btn-small btn-success" ng-click="join(tournament)">
							<i class="fa fa-plus"></i> Join
						</button>
					</span>
					<span ng-show="tournament.tournament.state != 'pending' || !loggedIn">
						{{tournament.tournament.state}}
					</span>
				</td>
			</tr>
		</tbody>
	</table>
	<div ng-show="activeBracket">
		<button class="btn pull-right btn-small" ng-click="activeBracket=''">X</button>
		<div class="view-iframe">
		</div>
	</div>
</div>
<div class="container" ng-show="activeTournament">
	<div class="row-fluid">
		<h3>{{activeTournament.tournament.name}}</h3>
		<strong class="pull-left">
			{{activeTournament.tournament.state}}
			<span class="badge">
				{{activeTournament.tournament.participantsCount}} / {{activeTournament.tournament.signupCap}}
			</span>
		</strong>
		<button class="btn btn-danger pull-right" ng-click="drop()">
			<i class="fa fa-minus-square" /> Drop
		</button>
	</div>
	<div class="row-fluid">
		<div class="span6 well">
			<div ng-show="match" class="active-match">
				<h3>Round {{match.match.round}}</h3>
				<p>
					<strong>{{match.player1Name}}</strong><span class="vs"> vs. </span><strong>{{match.player2Name}}</strong>
				</p>
				<p>
					Add your opponents BattleTag to your friends list then play a best of 3 match.  Report the results after!
				</p>
				<h3>Results</h3>
				<form class="form-horizontal">
					<label>Winner</label>
					<select ng-model="winnerReport" ng-change="sendResult()">
						<option value="">-still playing-</option>
						<option value="{{match.match.player1Id}}">{{match.player1Name}}</option>
						<option value="{{match.match.player2Id}}">{{match.player2Name}}</option>
					</select>
				</form>
				<div ng-show="matchError">
					<p>
						<strong>{{idNameMap[matchError.report[0].user]}}</strong> reports <strong>{{idNameMap[matchError.report[0].winner]}}</strong> won.
					</p>
					<p>
						<strong>{{idNameMap[matchError.report[1].user]}}</strong> reports <strong>{{idNameMap[matchError.report[1].winner]}}</strong> won.
					</p>
				</div>
			</div>
			<div ng-show="!match">
				<strong>You are not currently in any matches.</strong>
			</div>
		</div>
		<div class="span6">
			<ng-include src="'views/tournament-chat.html'"></ng-include>
		</div>
	</div>
	<div class="active-iframe" ng-show="activeTournament.tournament.state=='underway'">
	</div>
</div>